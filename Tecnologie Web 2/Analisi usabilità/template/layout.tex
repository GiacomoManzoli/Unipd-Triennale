\documentclass[a4paper,12pt]{article}

\usepackage[italian]{babel}
\usepackage[utf8]{inputenc} % permette l'inserimento di caratteri accentati da tastiera nel documento sorgente.
\usepackage[T1]{fontenc} % specifica la codifica dei font da usare nel documento stampato.
\usepackage{lscape}
\usepackage{times} % per caricare un font scalabile
\usepackage{indentfirst} % rientra il primo capoverso di ogni unitÃ  di sezionamento.
\usepackage{titlesec}
\usepackage{makecell}
\usepackage[svgnames]{xcolor} 
\usepackage{xspace}
\usepackage{xstring}
\usepackage{graphicx} % permette l'inserimento di immagini
\usepackage{multirow}
\usepackage{microtype} % migliora il riempimento delle righe
\usepackage{hyperref} % per gestione url
\hypersetup{
    colorlinks=true,       % false: boxed links; true: colored links
    linkcolor=black,          % color of internal links (change box color with linkbordercolor)
    citecolor=green,        % color of links to bibliography
    filecolor=magenta,      % color of file links
    urlcolor=blue           % color of external links
}
\usepackage{url} % per le url in monospace
\usepackage{eurosym} % simbolo euro
\usepackage{lastpage} % permette di sapere l'ultima pagina
\usepackage{fancyhdr} % gestione personalizzata header e footer
\usepackage[a4paper,portrait,top=3.5cm,bottom=3.5cm,left=3cm,right=3cm,bindingoffset=5mm]{geometry} % imposta i margini di pagina nelle classi standard.
\usepackage{hyperref} % abilita i riferimenti ipertestuali.
\usepackage{caption} %per le immagini
\usepackage{subcaption} %per le immagini
\usepackage{placeins} %per i floatbarrier
\usepackage{float} %per il posizionamento delle figure
\usepackage{verbatim} %per i commenti multiriga
\usepackage{longtable} % per le tabelle multipagina
\usepackage{diagbox}
\usepackage{hhline}
\usepackage{array} % per il testo nelle tabelle
\usepackage{multirow}
\usepackage{dirtree}
\usepackage{placeins} % \FloatBarrier per fare il flush delle immagini
\usepackage{tabularx} 

\usepackage[titletoc,title]{appendix}
\graphicspath{{./immagini/}} % da mettere per indicare le cartelle delle immagini

\let\stdsection\section
\renewcommand\section{\newpage\stdsection}

%\lhead{\scuola}
\chead{}
\rhead{\leftmark}
\lfoot{}
\cfoot{}
\rfoot{Pagina: \thepage\ / \pageref{LastPage}}
\renewcommand{\headrulewidth}{0.4pt}
\renewcommand{\footrulewidth}{0.4pt}
\pagestyle{fancy}
\setlength{\headheight}{15pt}

\titleclass{\subsubsubsection}{straight}[\subsection]

\renewcommand\thesubsubsection{\thesubsection.\arabic{subsubsection}}
\newcounter{subsubsubsection}[subsubsection]
\renewcommand\thesubsubsubsection{\thesubsubsection.\arabic{subsubsubsection}}

\titleformat{\subsubsubsection}
  {\normalfont\normalsize\bfseries}{\thesubsubsubsection}{1em}{}
\titlespacing*{\subsubsubsection}
{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}

\makeatletter
\def\toclevel@subsubsection{3}
\def\toclevel@subsubsubsection{4}
\def\l@subsubsubsection{\@dottedtocline{4}{7em}{4em}}
\def\l@paragraph{\@dottedtocline{5}{10em}{5em}}
\def\l@subparagraph{\@dottedtocline{6}{14em}{6em}}
\makeatother

\setcounter{secnumdepth}{4}
\setcounter{tocdepth}{4}

\newcommand{\Cline}[2]{\noalign{\vskip-0.2pt}\hhline{|>{\arrayrulecolor{gray!30}}*{#1}{-}>{\arrayrulecolor{black}}|*{#2}{-}}\noalign{\vskip-0.2pt}}